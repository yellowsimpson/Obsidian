회귀와 로지스틱 회귀를 혼동하지 말것!!
로지스틱 회귀는 분류 알고리즘이다

#4.3.1 보스턴 주택 가격 데이터셋

[코드4-23 보스턴 주택 데이터셋 로드하기]
```python
from tensorflow.keras.datasets import boston_housing

(train_data, train_targets), (test_data, test_targets) = (boston_housing.load_dat())
```

#4.3.2 데이터 준비

[코드4-24 데이터 정규화하기] __시험!!__
```python
mean = train_data.mean(axis=0)     #훈련데이터의 평균 계산
train_data -= mean                 #훈련데이터에서 평균 빼기
std = train_data.std(axis=0)       #훈련데이터의 표준편차 계산
train_data /= std                  #훈련데터를 표준 편차로 나눔

test_data -= mean                  #테스트 데이터에서도 훈련 데이터의 평균을 빼고
test_data /= std                   #훈련 데이터의 표준편차로 나눔
```
__test data를 정규화할 때 사용한 값이__ *train data* __에서 계산한 값이다__

```
코드 설명
test_data -= mean 의 부분 설명

- `train_data`의 평균 `mean`을 `test_data`에서 뺌.
- 즉, 훈련 데이터 기준으로 평균(mean)을 맞춰주는 작업이야.
- 왜냐하면, 훈련할 때 사용한 기준과 동일한 기준으로 테스트 데이터를 변환해야 **모델이 일관되게 동작**할 수 있기 때문이야.

`test_data /= std`의 부분 설명
- 마찬가지로 `train_data`의 표준편차 `std`로 나눠줌.
- 이렇게 하면 테스트 데이터도 훈련 데이터처럼 평균 0, 표준편차 1인 분포로 맞춰짐.

### 🔑 핵심 포인트

- **테스트 데이터는 훈련 데이터의 평균과 표준편차를 사용해서 정규화해야 한다.**
- 테스트 데이터의 자체 평균이나 표준편차를 사용하면 훈련 시와 다른 분포를 가지게 되어 **일관성이 깨짐**.
- 이건 데이터 누수(data leakage)를 방지하고, __공정한 평가__를 하기 위한 전형적인 방식이야.
```

#4.3.3 모델 구성
훈련 데이터의 개수가 적을수록 과대적합이 더 쉽게 일어나므로 작은 모델을 사용하는 것이 과대적합을 피하는 방법이다.

```python
def build model():
	model = keras.Sequential([
		layers.Dense(64, activation='relu'),
		layers.Dense(64, activation='relu'),
		layers.Dense(1) #Dense(1) : 선형층, 스칼라 회귀
		#값을 1개(주택 가격) 예측하기 때문
	])

model.compile(optimizer='rmsprop', loss'mse', metrics=["mae"])
return model
```

#4.3.4 K-겹 검증을 사용한 훈련 검증
![[스크린샷 2025-02-18 오후 2.10.22.png]]

```python
k = 4
num_val_samples = len(train_data) // k
num_epochs = 100
all_scores = []
for i in range(k):
	print(f)


```


#4.3.6 정리
1. 회귀는 분류에서 사용했던 것과는 다른 손실 함수를 사용한다. 평균 제곱 오차는 회귀에서 자주 사용되는 손실 함수이다.
2. 비슷하게 회귀에서 사용되는 평가 지표는 분류와 다르다. 당연히 정확도 개념은 회귀에 적용되지 않는다. 일반적인 회귀 지표는 평균 절대 오차(MAE)이다.
3. 입력 데이터의 특성이 서로 다른 범위를 가지면 전처리 단계에서 각 특성을 개별적으로 스케일 조정해야 된다.
4. 가용한 데이터가 적다면 K-겹 검증을 사용하는 것이 신뢰할 수 있는 모델 평가 방법이다.
5. 가용한 훈련 데이터가 적다면 과대적합을 피하기 위해 중간층의 수를 줄인 작은 모델을 사용한 것이 좋다.


