íšŒê·€(regression)ì™€ ë¡œì§€ìŠ¤í‹± íšŒê·€(logistic regression)ë¥¼ í˜¼ë™í•˜ì§€ ë§ê²ƒ!!
__regression == continuous regression__

ë¡œì§€ìŠ¤í‹± íšŒê·€ëŠ” ë¶„ë¥˜ ì•Œê³ ë¦¬ì¦˜ì´ë‹¤


- 4.3.1 ë³´ìŠ¤í„´ ì£¼íƒ ê°€ê²© ë°ì´í„°ì…‹

[ì½”ë“œ4-23 ë³´ìŠ¤í„´ ì£¼íƒ ë°ì´í„°ì…‹ ë¡œë“œí•˜ê¸°]
```python
from tensorflow.keras.datasets import boston_housing

(train_data, train_targets), (test_data, test_targets) = (boston_housing.load_data())
```

```
>>> train_data.shape
(404, 13)             #(í›ˆë ¨ ìƒ˜í”Œ, feature)
>>> test_data.shape
(192, 13)             #(í…ŒìŠ¤íŠ¸ ìƒ˜í”Œ, feature)
```


- 4.3.2 ë°ì´í„° ì¤€ë¹„

[ì½”ë“œ4-24 ë°ì´í„° ì •ê·œí™”í•˜ê¸°] __ì‹œí—˜!!__
```python
mean = train_data.mean(axis=0)     #í›ˆë ¨ë°ì´í„°ì˜ í‰ê·  ê³„ì‚°
train_data -= mean                 #í›ˆë ¨ë°ì´í„°ì—ì„œ í‰ê·  ë¹¼ê¸°
std = train_data.std(axis=0)       #í›ˆë ¨ë°ì´í„°ì˜ í‘œì¤€í¸ì°¨ ê³„ì‚°
train_data /= std                  #í›ˆë ¨ë°í„°ë¥¼ í‘œì¤€ í¸ì°¨ë¡œ ë‚˜ëˆ”

test_data -= mean                  #í…ŒìŠ¤íŠ¸ ë°ì´í„°ì—ì„œë„ í›ˆë ¨ ë°ì´í„°ì˜ í‰ê· ì„ ë¹¼ê³ 
test_data /= std                   #í›ˆë ¨ ë°ì´í„°ì˜ í‘œì¤€í¸ì°¨ë¡œ ë‚˜ëˆ”
```
__test dataë¥¼ ì •ê·œí™”í•  ë•Œ ì‚¬ìš©í•œ ê°’ì´__ *train data* __ì—ì„œ ê³„ì‚°í•œ ê°’ì´ë‹¤__

```
ì½”ë“œ ì„¤ëª…
test_data -= mean ì˜ ë¶€ë¶„ ì„¤ëª…

- `train_data`ì˜ í‰ê·  `mean`ì„ `test_data`ì—ì„œ ëºŒ.
- ì¦‰, í›ˆë ¨ ë°ì´í„° ê¸°ì¤€ìœ¼ë¡œ í‰ê· (mean)ì„ ë§ì¶°ì£¼ëŠ” ì‘ì—…ì´ì•¼.
- ì™œëƒí•˜ë©´, í›ˆë ¨í•  ë•Œ ì‚¬ìš©í•œ ê¸°ì¤€ê³¼ ë™ì¼í•œ ê¸°ì¤€ìœ¼ë¡œ í…ŒìŠ¤íŠ¸ ë°ì´í„°ë¥¼ ë³€í™˜í•´ì•¼ **ëª¨ë¸ì´ ì¼ê´€ë˜ê²Œ ë™ì‘**í•  ìˆ˜ ìˆê¸° ë•Œë¬¸ì´ì•¼.

`test_data /= std`ì˜ ë¶€ë¶„ ì„¤ëª…
- ë§ˆì°¬ê°€ì§€ë¡œ `train_data`ì˜ í‘œì¤€í¸ì°¨ `std`ë¡œ ë‚˜ëˆ ì¤Œ.
- ì´ë ‡ê²Œ í•˜ë©´ í…ŒìŠ¤íŠ¸ ë°ì´í„°ë„ í›ˆë ¨ ë°ì´í„°ì²˜ëŸ¼ í‰ê·  0, í‘œì¤€í¸ì°¨ 1ì¸ ë¶„í¬ë¡œ ë§ì¶°ì§.

### ğŸ”‘ í•µì‹¬ í¬ì¸íŠ¸

- **í…ŒìŠ¤íŠ¸ ë°ì´í„°ëŠ” í›ˆë ¨ ë°ì´í„°ì˜ í‰ê· ê³¼ í‘œì¤€í¸ì°¨ë¥¼ ì‚¬ìš©í•´ì„œ ì •ê·œí™”í•´ì•¼ í•œë‹¤.**
- í…ŒìŠ¤íŠ¸ ë°ì´í„°ì˜ ìì²´ í‰ê· ì´ë‚˜ í‘œì¤€í¸ì°¨ë¥¼ ì‚¬ìš©í•˜ë©´ í›ˆë ¨ ì‹œì™€ ë‹¤ë¥¸ ë¶„í¬ë¥¼ ê°€ì§€ê²Œ ë˜ì–´ **ì¼ê´€ì„±ì´ ê¹¨ì§**.
- ì´ê±´ ë°ì´í„° ëˆ„ìˆ˜(data leakage)ë¥¼ ë°©ì§€í•˜ê³ , __ê³µì •í•œ í‰ê°€__ë¥¼ í•˜ê¸° ìœ„í•œ ì „í˜•ì ì¸ ë°©ì‹ì´ì•¼.
```

- 4.3.3 ëª¨ë¸ êµ¬ì„±
í›ˆë ¨ ë°ì´í„°ì˜ ê°œìˆ˜ê°€ ì ì„ìˆ˜ë¡ ê³¼ëŒ€ì í•©ì´ ë” ì‰½ê²Œ ì¼ì–´ë‚˜ë¯€ë¡œ ì‘ì€ ëª¨ë¸ì„ ì‚¬ìš©í•˜ëŠ” ê²ƒì´ ê³¼ëŒ€ì í•©ì„ í”¼í•˜ëŠ” ë°©ë²•ì´ë‹¤.

```python
def build model():
	model = keras.Sequential([
		layers.Dense(64, activation='relu'),
		layers.Dense(64, activation='relu'),
		layers.Dense(1) #Dense(1) : ì„ í˜•ì¸µ, ìŠ¤ì¹¼ë¼ íšŒê·€
		#ê°’ì„ 1ê°œ(ì£¼íƒ ê°€ê²©) ì˜ˆì¸¡í•˜ê¸° ë•Œë¬¸
	])

model.compile(optimizer='rmsprop', loss'mse', metrics=["mae"])
return model
```

- 4.3.4 K-ê²¹ ê²€ì¦ì„ ì‚¬ìš©í•œ í›ˆë ¨ ê²€ì¦
__K ê²¹ êµì°¨ ê²€ì¦(K-fold cross-validation)__ *ìš©ì–´ ì‹œí—˜!!*
-> ë°ì´í„°ë¥¼ Kê°œì˜ ë¶„í• ë¡œ ë‚˜ëˆ„ê³ , Kê°œì˜ ëª¨ë¸ì„ ê°ê° ë§Œë“¤ì–´ K-1ê°œì˜ ë¶„í• ì—ì„œ í›ˆë ¨í•˜ê³  ë‚˜ë¨¸ì§€ ë¶„í• ì—ì„œ í‰ê°€í•˜ëŠ” ë°©ë²•

![[ìŠ¤í¬ë¦°ìƒ· 2025-02-18 ì˜¤í›„ 2.10.22.png]]

```python
k = 4           # ë°ì´í„°ì…‹ì„ 4ê°œë¡œ ë‚˜ëˆ” (4-fold cross-validation)
num_val_samples = len(train_data) // k
num_epochs = 100
all_scores = []
for i in range(k):
	print(f"#{i} ë²ˆì§¸ í´ë“œ ì²˜ë¦¬ ì¤‘")
	#ë°ì´í„°ë¥¼ 4ë“±ë¶„í•´ì„œ, ê·¸ì¤‘ í•œ ì¡°ê°(`i`)ì„ ê²€ì¦(validation)ì— ì“°ê³  ë‚˜ë¨¸ì§€ 3ì¡°ê°ì„ í›ˆë ¨(train)ì— ì‚¬ìš©í•¨.

	val_data = train_data[i * num_val_samples: (i + 1) * num_val_samples]
	val_targets = train_targets[i * num_val_samples: (i + 1) * num_val_samples]
	#ê²€ì¦ ë°ì´í„°ì™€ í•´ë‹¹ íƒ€ê¹ƒê°’(`val_targets`)ì„ ì„ íƒí•¨.
	
	partial_train_data = np.concatenate(
		[train_data[:i * num_val_samples],
		train_data[(i + 1) * num_val_samples:]],
		axis = 0)
	#ê²€ì¦ ë°ì´í„°ë¥¼ ì œì™¸í•œ ë‚˜ë¨¸ì§€ ë°ì´í„°ë¥¼ ëª¨ë‘ ì´ì–´ë¶™ì—¬ì„œ í›ˆë ¨ ë°ì´í„°ë¡œ ì‚¬ìš©.

	partial_train_targets = np.concatenate(
		[train_targets[:i * num_val_samples],
		train_targets[(i + 1) * num_val_samples:]],
		axis = 0)
	

	model = build_model()
	model.fit(partial_train_data, partial_train_targets,
		epochs = num_epochs, batch_size = 16, verbose = 0)
	#ìœ„ì—ì„œ êµ¬ì„±í•œ í›ˆë ¨ ë°ì´í„°ë¡œ ëª¨ë¸ì„ í•™ìŠµì‹œí‚´.

	val_mse, val_mae = model.evaluate(val_data, val_targets, verbos = 0)
	all_scores.append(val_mae)
```



- 4.3.6 ì •ë¦¬
1. íšŒê·€ëŠ” ë¶„ë¥˜ì—ì„œ ì‚¬ìš©í–ˆë˜ ê²ƒê³¼ëŠ” ë‹¤ë¥¸ ì†ì‹¤ í•¨ìˆ˜ë¥¼ ì‚¬ìš©í•œë‹¤. í‰ê·  ì œê³± ì˜¤ì°¨ëŠ” íšŒê·€ì—ì„œ ìì£¼ ì‚¬ìš©ë˜ëŠ” ì†ì‹¤ í•¨ìˆ˜ì´ë‹¤.
2. ë¹„ìŠ·í•˜ê²Œ íšŒê·€ì—ì„œ ì‚¬ìš©ë˜ëŠ” í‰ê°€ ì§€í‘œëŠ” ë¶„ë¥˜ì™€ ë‹¤ë¥´ë‹¤. ë‹¹ì—°íˆ ì •í™•ë„ ê°œë…ì€ íšŒê·€ì— ì ìš©ë˜ì§€ ì•ŠëŠ”ë‹¤. ì¼ë°˜ì ì¸ íšŒê·€ ì§€í‘œëŠ” í‰ê·  ì ˆëŒ€ ì˜¤ì°¨(MAE)ì´ë‹¤.
3. ì…ë ¥ ë°ì´í„°ì˜ íŠ¹ì„±ì´ ì„œë¡œ ë‹¤ë¥¸ ë²”ìœ„ë¥¼ ê°€ì§€ë©´ ì „ì²˜ë¦¬ ë‹¨ê³„ì—ì„œ ê° íŠ¹ì„±ì„ ê°œë³„ì ìœ¼ë¡œ ìŠ¤ì¼€ì¼ ì¡°ì •í•´ì•¼ ëœë‹¤.
4. ê°€ìš©í•œ ë°ì´í„°ê°€ ì ë‹¤ë©´ K-ê²¹ ê²€ì¦ì„ ì‚¬ìš©í•˜ëŠ” ê²ƒì´ ì‹ ë¢°í•  ìˆ˜ ìˆëŠ” ëª¨ë¸ í‰ê°€ ë°©ë²•ì´ë‹¤.
5. ê°€ìš©í•œ í›ˆë ¨ ë°ì´í„°ê°€ ì ë‹¤ë©´ ê³¼ëŒ€ì í•©ì„ í”¼í•˜ê¸° ìœ„í•´ ì¤‘ê°„ì¸µì˜ ìˆ˜ë¥¼ ì¤„ì¸ ì‘ì€ ëª¨ë¸ì„ ì‚¬ìš©í•œ ê²ƒì´ ì¢‹ë‹¤.


