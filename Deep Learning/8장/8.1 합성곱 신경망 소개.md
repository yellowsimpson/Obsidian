
합성곱 신경망 == CNN(convolutional neural network)
Dense connected network == fully connected network(완전 연결 층)

[코드8-1 간단한 컨브넷 만들기]
```python
from tensorflow import keras
from tensorflow.keras import layers

inputs = keras.Input(shape=(28, 28, 1)) #(높이, 너비, 채널수(1은 흑백))
x = layers.Conv2D(filters=32, kernel_size=3, activation="relu")(inputs)
x = layers.MaxPooling2D(pool_size=2)(x)
x = layers.Conv2D(filters=64, kernel_size=3, activation="relu")(x)
x = layers.MaxPooling2D(pool_size=2)(x)
x = layers.Conv2D(filters=128, kernel_size=3, activation="relu")(x)
x = layers.Flatten()(x)

outputs = layers.Dense(10, activation="softmax")(x)
model = keras.Model(inputs=inputs, outputs=outputs)
```

```pyhton
model.summary()

Model: "model" 
_________________________________________________________________ 
Layer (type)                     Output Shape         Param # ================================================================= 
input_1 (InputLayer)          [(None, 28, 28, 1)]       0 
conv2d (Conv2D)                (None, 26, 26, 32)      320   #32 X (1 X 3^2 + 1)
max_pooling2d (MaxPooling2d)   (None, 13, 13, 32)       0 
conv2d_1 (Conv2D)              (None, 11, 11, 64)      18496 #64 X (32 X 3^2 + 1)
max_pooling2d_1 (MaxPoolin2D)  (None, 5, 5, 64)         0  
conv2d_2 (Conv2D)              (None, 3, 3, 128)       73856 #128 X ()
flatten (Flatten)              (None, 1152)             0 
dense (Dense)                  (None, 10)              11530 ================================================================= 
Total params: 104, 202 (407.04 KB) 
Trainable params: 104, 202 (407.04 KB) 
Non-trainable params: 0 (0.00 Byte) 
_________________________________________________________________
```
__-> MaxPooling2D층마다 특성 맵의 크기가 반으로 줄어듬!!__


[코드8-3 MNIST 이미지에서 컨브넷 훈련하기]
```python
from tensorflow.keras.datasets import mnist

(train_images, train_labels), (test_images, test_labels) = mnist.load_data()
train_images = train_images.reshape((60000, 28, 28, 1))
train_images = train_images.astype("float32") / 255
test_images = test_images.reshape((10000, 28, 28, 1))
test_images = test_images.astype("float32") / 255
model.compile(optimizer="rmsprop",
	loss="sparse_categorical_crossentropy",
	metrics=["accuracy"])

model.fit(train_images, train_labels, epochs=5, batch_size=64)
```

```python
test_loss, test_acc = model.evaluate(test_images, test_labels)
print(f"테스트 정확도: {test_acc:.3f}")
>>  테스트 정확도: 0.991
```

- 8.1.1 합성곱 연산
__Dense connected network == fully connected network(완전 연결 층)__ 
는 입력 특성 공간에 __전역 패턴을 학습__
합성곱 신경망(convolutional neural network)은 __지역 패턴__ 을 학습

- 학습된 패턴은 __평행 이동 불변성(translation invariant)__ 을 가진다.
- 컨브넷(CNN)은 패턴의 __공간적 계층 구조__ 를 학습한다.

![[스크린샷 2025-05-28 오후 6.05.22.png]]

- 8.1.2 최대 풀링 연산
[코드 8-5 최대 풀링 층이 빠진 잘못된 구조의 컨브넷]
```python
inputs = keras.Input(shape=(28, 28, 1))
x = layers.Conv2D(filters=32, kernel_size=3, activation="relu")(inputs)
x = layers.Conv2D(filters=64, kernel_size=3, activation="relu")(x)
x = layers.Conv2D(filters=128, kernel_size=3, activation="relu")(x)
x = layers.Flatten()(x)
outputs = layers.Dense(10, activation="softmax")(x)
model_no_max_pool = keras.Model(inputs=inputs, outputs=outputs)

model_no_max_pool.summary()
```
```
Model: "functional_2"

┏━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━┓
┃ Layer (type)                    ┃ Output Shape           ┃       Param # ┃
┡━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━┩
│ input_layer_2 (InputLayer)      │ (None, 28, 28, 1)      │             0 │
├─────────────────────────────────┼────────────────────────┼───────────────┤
│ conv2d_6 (Conv2D)               │ (None, 26, 26, 32)     │           320 │
├─────────────────────────────────┼────────────────────────┼───────────────┤
│ conv2d_7 (Conv2D)               │ (None, 24, 24, 64)     │        18,496 │
├─────────────────────────────────┼────────────────────────┼───────────────┤
│ conv2d_8 (Conv2D)               │ (None, 22, 22, 128)    │        73,856 │
├─────────────────────────────────┼────────────────────────┼───────────────┤
│ flatten_2 (Flatten)             │ (None, 61952)          │             0 │
├─────────────────────────────────┼────────────────────────┼───────────────┤
│ dense_2 (Dense)                 │ (None, 10)             │       619,530 │
└─────────────────────────────────┴────────────────────────┴───────────────┘

 Total params: 712,202 (2.72 MB)

 Trainable params: 712,202 (2.72 MB)

 Non-trainable params: 0 (0.00 B)
```


-> 위의 컨브넷의 문제점
1. 특성의 공간적 계층 구조를 학습하는데 도움이 안됨
2. 작은 모델에 비해 너무 많은 파라미터가 있음 
		->마지막 출력 층에 22 X 22 X 128 = 61952개의 원소가 있음

__다운 샘플링을 하는 이유
	= > 처리할 특성 맵의 가중치 갯수를 줄이기 위해 사용!!__

다운 샘플링 방법 2가지
1. Max Plooing
2. Average Plooing
	__-> Average Plooing보다 Max Plooing이 성능이 더 좋음!!__


